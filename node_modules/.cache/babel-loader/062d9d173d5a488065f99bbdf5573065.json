{"ast":null,"code":"import _regeneratorRuntime from\"E:\\\\GitHub\\\\swapi-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"E:\\\\GitHub\\\\swapi-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"E:\\\\GitHub\\\\swapi-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _defineProperty from\"E:\\\\GitHub\\\\swapi-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _slicedToArray from\"E:\\\\GitHub\\\\swapi-test\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import axios from'axios';import{useHistory}from'react-router-dom';import keys from'lodash/keys';import{Box,Grid,Button,TextField,InputAdornment,IconButton,Typography}from'@material-ui/core';import{Visibility,VisibilityOff}from'@material-ui/icons';import{USERNAME,PASSWORD}from'../Constants/Login_Constants';import{searchAllPeople}from'../../SWAPI';var Login=function Login(){var _useState11;var signal=axios.CancelToken.source();var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),passwordVisibility=_useState2[0],setPasswordVisibility=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),errors=_useState4[0],setErrors=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),invalidError=_useState6[0],setInvalidError=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isLoggingIn=_useState8[0],setLoggingIn=_useState8[1];var _useState9=useState((_useState11={},_defineProperty(_useState11,USERNAME,''),_defineProperty(_useState11,PASSWORD,''),_useState11)),_useState10=_slicedToArray(_useState9,2),loginData=_useState10[0],setLoginData=_useState10[1];useEffect(function(){document.title=\"Login | Swapi App\";return function(){signal.cancel('Request Cancelled');};},[]);var handlePasswordVisibility=function handlePasswordVisibility(){setPasswordVisibility(function(prevStateValue){return!prevStateValue;});};var handleChange=function handleChange(name){return function(e){setErrors(function(prevErrors){delete prevErrors[name];return _objectSpread({},prevErrors);});setInvalidError(false);setLoginData(_objectSpread(_objectSpread({},loginData),{},_defineProperty({},name,e.target.value)));};};// const checkFormValidity = (data, existingErrors) => {\n//   const REQUIRED_FIELD = 'Required Field';\n//   const errors = existingErrors;\n//   if (!data[USERNAME]) errors[USERNAME] = REQUIRED_FIELD;\n//   if (!data[PASSWORD]) errors[PASSWORD] = REQUIRED_FIELD;\n//   setErrors(errors);\n// };\nvar checkLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,_setLoginData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoggingIn(true);_context.prev=1;_context.next=4;return searchAllPeople(loginData[USERNAME],signal.token);case 4:response=_context.sent;console.log(response);if(response&&response.count===1&&response.results[0].name===loginData[USERNAME]&&response.results[0].birth_year===loginData[PASSWORD]){console.log('Login Successful',response.results[0]);localStorage.setItem('userData',response.results[0]);history.push('/home');}else{setInvalidError(true);setLoginData((_setLoginData={},_defineProperty(_setLoginData,USERNAME,''),_defineProperty(_setLoginData,PASSWORD,''),_setLoginData));}setLoggingIn(false);_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](1);console.log('API Error',_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[1,10]]);}));return function checkLogin(){return _ref.apply(this,arguments);};}();var handleLogin=function handleLogin(){console.log('Login');// checkFormValidity(loginData, errors);\n// console.log(errors);\nif(keys(errors).length===0){checkLogin();}};return/*#__PURE__*/React.createElement(Box,{style:{position:'absolute',left:'50%',top:'50%',transform:'translate(-50%, -50%)'}},/*#__PURE__*/React.createElement(Grid,{container:true,spacing:2},invalidError&&/*#__PURE__*/React.createElement(Grid,{item:true,xs:12,sm:12},/*#__PURE__*/React.createElement(Typography,{color:\"error\"},\"Invalid Credentials\")),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12,sm:12},/*#__PURE__*/React.createElement(TextField,{type:\"username\",id:\"username\",label:\"Username\",placeholder:\"Username\",name:\"Username\",fullWidth:true,value:loginData[USERNAME],onChange:handleChange(USERNAME),disabled:isLoggingIn,required:true,InputLabelProps:{shrink:true},error:!!errors[USERNAME],helperText:errors[USERNAME]})),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12,sm:12},/*#__PURE__*/React.createElement(TextField,{type:passwordVisibility?'text':'password',id:\"password\",label:\"Password\",placeholder:\"Password\",name:\"password\",fullWidth:true,value:loginData[PASSWORD],onChange:handleChange(PASSWORD),disabled:isLoggingIn,required:true,InputLabelProps:{shrink:true},error:!!errors[PASSWORD],helperText:errors[PASSWORD],InputProps:{endAdornment:/*#__PURE__*/React.createElement(InputAdornment,{position:\"end\"},/*#__PURE__*/React.createElement(IconButton,{\"aria-label\":\"Toggle password visibility\",onClick:function onClick(){return handlePasswordVisibility();}},passwordVisibility?/*#__PURE__*/React.createElement(Visibility,null):/*#__PURE__*/React.createElement(VisibilityOff,null)))}})),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(Button,{variant:\"contained\",color:\"primary\",onClick:handleLogin,disabled:isLoggingIn},\"Login\"))));};export default Login;","map":{"version":3,"sources":["E:/GitHub/swapi-test/src/Login/Components/Login.js"],"names":["React","useState","useEffect","axios","useHistory","keys","Box","Grid","Button","TextField","InputAdornment","IconButton","Typography","Visibility","VisibilityOff","USERNAME","PASSWORD","searchAllPeople","Login","signal","CancelToken","source","history","passwordVisibility","setPasswordVisibility","errors","setErrors","invalidError","setInvalidError","isLoggingIn","setLoggingIn","loginData","setLoginData","document","title","cancel","handlePasswordVisibility","prevStateValue","handleChange","name","e","prevErrors","target","value","checkLogin","token","response","console","log","count","results","birth_year","localStorage","setItem","push","handleLogin","length","position","left","top","transform","shrink","endAdornment"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useHistory } from 'react-router-dom';\r\nimport keys from 'lodash/keys';\r\nimport {\r\n  Box,\r\n  Grid,\r\n  Button,\r\n  TextField,\r\n  InputAdornment,\r\n  IconButton,\r\n  Typography,\r\n} from '@material-ui/core';\r\nimport { Visibility, VisibilityOff } from '@material-ui/icons';\r\nimport { USERNAME, PASSWORD } from '../Constants/Login_Constants';\r\nimport { searchAllPeople } from '../../SWAPI';\r\n\r\nconst Login = () => {\r\n  const signal = axios.CancelToken.source();\r\n  let history = useHistory();\r\n  const [passwordVisibility, setPasswordVisibility] = useState(false);\r\n  const [errors, setErrors] = useState({});\r\n  const [invalidError, setInvalidError] = useState(false);\r\n  const [isLoggingIn, setLoggingIn] = useState(false);\r\n  const [loginData, setLoginData] = useState({\r\n    [USERNAME]: '',\r\n    [PASSWORD]: '',\r\n  });\r\n\r\n  useEffect(() => {\r\n    document.title = `Login | Swapi App`;\r\n    return () => {\r\n      signal.cancel('Request Cancelled');\r\n    };\r\n  }, []);\r\n\r\n  const handlePasswordVisibility = () => {\r\n    setPasswordVisibility((prevStateValue) => {\r\n      return !prevStateValue;\r\n    });\r\n  };\r\n\r\n  const handleChange = (name) => (e) => {\r\n    setErrors((prevErrors) => {\r\n      delete prevErrors[name];\r\n      return { ...prevErrors };\r\n    });\r\n    setInvalidError(false);\r\n    setLoginData({ ...loginData, [name]: e.target.value });\r\n  };\r\n\r\n  // const checkFormValidity = (data, existingErrors) => {\r\n  //   const REQUIRED_FIELD = 'Required Field';\r\n  //   const errors = existingErrors;\r\n  //   if (!data[USERNAME]) errors[USERNAME] = REQUIRED_FIELD;\r\n  //   if (!data[PASSWORD]) errors[PASSWORD] = REQUIRED_FIELD;\r\n  //   setErrors(errors);\r\n  // };\r\n\r\n  const checkLogin = async () => {\r\n    setLoggingIn(true);\r\n\r\n    try {\r\n      const response = await searchAllPeople(loginData[USERNAME], signal.token);\r\n      console.log(response);\r\n      if (\r\n        response &&\r\n        response.count === 1 &&\r\n        response.results[0].name === loginData[USERNAME] &&\r\n        response.results[0].birth_year === loginData[PASSWORD]\r\n      ) {\r\n        console.log('Login Successful', response.results[0]);\r\n        localStorage.setItem('userData', response.results[0]);\r\n        history.push('/home');\r\n      } else {\r\n        setInvalidError(true);\r\n        setLoginData({ [USERNAME]: '', [PASSWORD]: '' });\r\n      }\r\n      setLoggingIn(false);\r\n    } catch (error) {\r\n      console.log('API Error', error);\r\n    }\r\n  };\r\n\r\n  const handleLogin = () => {\r\n    console.log('Login');\r\n    // checkFormValidity(loginData, errors);\r\n    // console.log(errors);\r\n    if (keys(errors).length === 0) {\r\n      checkLogin();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Box\r\n      style={{\r\n        position: 'absolute',\r\n        left: '50%',\r\n        top: '50%',\r\n        transform: 'translate(-50%, -50%)',\r\n      }}\r\n    >\r\n      <Grid container spacing={2}>\r\n        {invalidError && (\r\n          <Grid item xs={12} sm={12}>\r\n            <Typography color=\"error\">Invalid Credentials</Typography>\r\n          </Grid>\r\n        )}\r\n        <Grid item xs={12} sm={12}>\r\n          <TextField\r\n            type=\"username\"\r\n            id=\"username\"\r\n            label=\"Username\"\r\n            placeholder=\"Username\"\r\n            name=\"Username\"\r\n            fullWidth\r\n            value={loginData[USERNAME]}\r\n            onChange={handleChange(USERNAME)}\r\n            disabled={isLoggingIn}\r\n            required\r\n            InputLabelProps={{\r\n              shrink: true,\r\n            }}\r\n            error={!!errors[USERNAME]}\r\n            helperText={errors[USERNAME]}\r\n          />\r\n        </Grid>\r\n        <Grid item xs={12} sm={12}>\r\n          <TextField\r\n            type={passwordVisibility ? 'text' : 'password'}\r\n            id=\"password\"\r\n            label=\"Password\"\r\n            placeholder=\"Password\"\r\n            name=\"password\"\r\n            fullWidth\r\n            value={loginData[PASSWORD]}\r\n            onChange={handleChange(PASSWORD)}\r\n            disabled={isLoggingIn}\r\n            required\r\n            InputLabelProps={{\r\n              shrink: true,\r\n            }}\r\n            error={!!errors[PASSWORD]}\r\n            helperText={errors[PASSWORD]}\r\n            InputProps={{\r\n              endAdornment: (\r\n                <InputAdornment position=\"end\">\r\n                  <IconButton\r\n                    aria-label=\"Toggle password visibility\"\r\n                    onClick={() => handlePasswordVisibility()}\r\n                  >\r\n                    {passwordVisibility ? <Visibility /> : <VisibilityOff />}\r\n                  </IconButton>\r\n                </InputAdornment>\r\n              ),\r\n            }}\r\n          />\r\n        </Grid>\r\n        <Grid item xs={12}>\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            onClick={handleLogin}\r\n            disabled={isLoggingIn}\r\n          >\r\n            Login\r\n          </Button>\r\n        </Grid>\r\n      </Grid>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"]},"metadata":{},"sourceType":"module"}